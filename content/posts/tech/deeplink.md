---
date: 2022-09-07
title: DeepLink
slug: /tech/deeplink
tags: [tech]
---

## 딥링크(Deeplink)란?

딥링크란 모바일 환경에 놓인 유저가 웹사이트 혹은 다른 앱에서 URL을 클릭했을 때, 앱을 실행시키고 특정 페이지로 이동하도록 돕는 기술. 모바일 앱에서 특성 화면으로 이동하도록 하는 기능으로 특정 주소 혹은 값을 입력하면 앱이 실행되거나 앱 내 특정 화면으로 이동시키는 기능을 수행한다. 딥링크가 사용되면 앱이 바로 실행되어 특정 화면으로 이동하는 경험을 하게 된다. 또는 지연된 딥링크라하여 앱 설치 후 실행하면 특정 화면으로 바로 이동할 수 있다.

유저를 앱 내 특정 페이지로 부드럽게 연결시키는 방법으로 딥링크를 사용한다. 가능한 한 많은 유저를 앱으로 유입시켜야 한다면 잘 작동하는 딥링크는 핵심이다. 링크를 클릭한 유저가 어떠한 이유로라도 중간에 이탈하지 않도록 제공되어야 한다.

- ex) 외부 광고배너 -> 딥링크 -> 앱 설치 유무에 따라 -> 앱실행 또는 스토어

참고) 지연된 딥링크(Deferred Deep Link) 란? 마켓에 랜딩되어 앱 설치 후 실행한 이용자가 앱 첫 화면이 아닌, 지정된 특정 앱 페이지로 이동되는 기능

## 딥링크 구분(3가지 방식)

- URI 스킴 방식(일반적인 방식): 앱에 URI 스킴(scheme) 값을 등록하여 딥링크 사용
- 유니버셜 링크 (Universal Link): iOS 제공. 도메인 주소를 이용한 딥링크 사용
- 앱링크(App Link): Android 제공. 도메인 주소를 이용한 딥링크 사용

### URI Scheme(URI 스킴) 방식

앱에 Scheme값을 등록하여 앱을 구분한다. 특정 스킴값을 호출하면 특정 앱이 오픈되고 경로에 따라 페이지를 특정한다.

- 형식: Scheme://Path
- Scheme 값: 앱 개발자가 정한 값으로 앱을 구분
- Path: 앱 내 특정 페이지를 지정

#### 한계

URI Scheme 딥링크의 경우, 링크를 클릭했으나 앱이 설치되어 있지 않을 때는 다른 곳으로의 이동(Fallback)이 불가능하다는 단점이 있다. 즉, 링크를 클릭해도 아무런 동작이 발생하지 않는다.

또 앱에서 제공하는 스킴의 소유권을 증명할 수 없으로 스킴이 서로 중복될 수 있는데, 앱 개발자 입장에서는 앱에 등록된 스킴값이 자신들의 앱만 사용하는 고유값인지 확인할 방법이 현재는 없다.

예를 들면 구글플레이의 경우, 앱을 오픈하기 위한 스킴 값으로 market:// 란 값을 사용하는데 원스토어나 삼성앱스토어도 동일한 앱스킴 사용하고 있다. 따라서 해당 스킴이 요청되었을 때 스킴을 제공하는 앱들을 사용자가 직접 선택해야 한다.

이를 위한 해결안으로 애플과 구글에서는 운영체제별 유니버셜 링크 (iOS 제공)와 앱링크 (Android 제공)를 제공하게 되었다.

참고) 안드로이드의 경우 Android Intent 활용하면 Fallback 설정할 수 있다.

### Universal Links(유니버셜 링크) & App Links(앱 링크)란?

Universal Links와 App Links는 각각 iOS와 Android에서 제공되는 딥링크 형태로, OS에 앱에 대한 도메인 주소를 등록함으로써 소유권을 증명한다. 도메인은 웹사이트마다 가지는 고유한 주소로 특정 도메인은 유니크하고, 도메인 소유자만이 관리할 수 있기 때문에 소유권이 증명되며 보장된다. 따라서 도메인 주소를 딥링크 실행값으로 사용한다.

예를 들면, 스마트폰 브라우저 앱 주소창에 http://naver.com 을 입력하면 네이버 앱이 바로 오픈된다.

소유권 인증 절차는 다음과 같다.

- 앱 빌드 시 앱을 열 도메인을 등록
- 보안을 위해 등록한 도메인의 특정 경로에 인증 텍스트를 심어둔다
- 앱이 설치된 후 OS 레벨에서 해당 도메인 경로의 인증 텍스트와 앱 빌드 시의 값이 동일한지 검증하여 소유권을 인지

동작은?

- 앱이 설치된 경우에는 앱 및 특정 페이지가 바로 열리고
- (앱이 설치되어 있지 않아) 딥링크 실패 시에는, 해당 도메인의 웹페이지로 이동

#### 한계

아직까지는 완전하지 않다. 모든 앱에서 유니버셜 링크와 앱링크 오픈을 지원하지 않는다. 즉, 완벽하게 대응 불가.

앱링크는 구글에서 만든 앱에서만 동작하고, 구글 이외에 앱에서는 정상적으로 동작하지 않고 유니버셜 링크도 애플에서 만든 앱 이외에는 정상적으로 동작하지 않는다.

## 딥링크 동작시 문제

### Safari 오류

사파리에서는 앱 설치 유무에 따라 다음과 같은 문구가 노출된다.

- 앱 미 설치시: 주소가 유효하지 않기 때문에 Safari가 해당 페이지를 열 수 없습니다.
- 앱 설치시: {앱이름}'에서 이 페이지를 열겠습니까?

이유는? URI Scheme은 소유권을 증명할 수 없다는 문제로 인해, Scheme 값이 중복되는 경우가 발생할 수 있다. 또 자바스크립트를 통해 딥링크를 동작시켜서 Safari의 외부 앱으로 이동하는 경우에는, 원래의 의도와는 다른 동작이 발생할 수도 있다. 그래서 iOS Safari에서는 URI Scheme 딥링크가 동작되는 경우, 위와 같이 경고 문구를 띄워서 유저에게 안내한다.

Safari의 경우, URI Scheme의 동작은 제한되어 있다.
사파리 브라우저의 경우 앱실행을 위한 딥링크가 요청되면 다음과 같은 에러메시지가 발생하는 경우가 있다.

- 에러메시지: 주소가 유효하지 않기 때문에 Safari에서 이 페이지를 열 수 없습니다.

링크에 유저를 리다이렉트할 수 있는 올바른 URI schemes이 없는 경우 이 오류 메시지가 표시된다. 일반적으로 테스트 목적으로 앱을 여러 번 계속 설치하고 제거하는 경우, 앱과의 정보를 확인하는데 시간이 걸리게 되어 발생한다.

해결안으로는 Safari 캐시를 삭제하여 (설정 > Safari > 방문 기록 및 웹 사이트 데이터 지우기) 오류를 제거할 수 있습니다. 또는 새 디바이스에서 다시 시도할 수 있다.

###

---

- https://www.airbridge.io/blog-ko/deeplink-101-for-marketers-and-developers
- https://help.branch.io/ko/faq/docs/safari-error-safari-cannot-open-this-page-because-address-is-invalid
