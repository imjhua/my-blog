---
title: "웹폰트 적용기"
date: 2022-07-18
---

## 웹폰트 적용기
웹폰트 적용하면서 겪었던 이슈들과 이를 해결하기 위한 노력들에 대해 공유해보려고 합니다.

### 웹폰트란? 
웹에서 쓰이는 폰트입니다. 폰트 파일을 다운로드하여 화면에 표시해주는 웹 전용 폰트로 사용자가 폰트를 설치하지 않아도 디자이너가 원하는 타이포그래피를 웹 페이지에 구현할 수 있게 하는 기술입니다.

참고)
* 타이포그래피:
타이포그래피란 보통 활자 서체의 배열, 사전적 의미로는 활판술을 의미하는데 근래에 이르러서는 문자를 활용한 그래픽 디자인 전반을 아우르는 단어로 통용되고 있다. 

## 작업 과정

### 디자이너의 요구사항
사용자에게 가장 먼저 노출되는 첫화면은 서비스에 대한 첫 느낌이 될 것이기에 메인 타이틀 문구는 페이지에서 가장 눈에 띄는 디자인 요소여야했고 이에 첫 화면에 노출되는 문구는 웹폰트로 적용해달라는 요구사항을 받았습니다.

### 적용해보기
웹 폰트를 적용해봅니다. 

1. 폰트를 다운로드 받아 저장소에 저장한다.
2. CSS의 @font-face 규칙을 사용해 폰트명세를 정의한다.
3. 정의된 폰트를 사용할 수 있도록 적용한다. 

참고)
적용전 웹폰트 라이센스는 미리 꼭 확인해볼 것!

#### 폰트 다운로드
폰트의 형식은 다양합니다. 웹에서 사용하는 woff 포맷인지 확인 후 다운로드 받고 저장소에 저장합니다.
- 저장소 Tenth2: http://mc.kakaocdn.net/console/kakaomobility#

참고)
- ttf(true type font), otf(open type font): pc에 설치하여 사용하는 폰트
- woff(web open font format): otf와 ttf를 압축하여 웹에서 사용할 수 있도록 만들어준 포맷
- eot: IE에서만 지원

#### font-face 정의
font-face규칙은 웹 글꼴명세입니다. 사용하고자 하는 폰트의 속성을 정의해두어 사용할 수 있도록 합니다.

- font-family: 폰트명 선언
- src: 폰트의 위치와 형식
- font-weight: 폰트 글자 굵기(가중치)
- font-style: 폰트의 스타일 (보통, 기울림 등)

가중치에 따라 폰트파일이 존재하므로, 동일한 font-family을 지정하되 개별 font-face로 선언하여 가중치에 맞는 폰트를 가져올 수 있도록 합니다.
```
@font-face {
  font-family: 'S-Core Dream';
  src: url('https://t1.kakaocdn.net/kakaomobility/fonts/S-Core-Dream-light/scdream1-webfont.woff2') format('woff2'),
      url('https://t1.kakaocdn.net/kakaomobility/fonts/S-Core-Dream-light/scdream1-webfont.woff') format('woff');
  font-weight: 100;
  font-style: normal;
}
@font-face {
  font-family: 'S-Core Dream';
  src: url('https://t1.kakaocdn.net/kakaomobility/fonts/S-Core-Dream-light/scdream2-webfont.woff2') format('woff2'),
      url('https://t1.kakaocdn.net/kakaomobility/fonts/S-Core-Dream-light/scdream2-webfont.woff') format('woff');
  font-weight: 200;
  font-style: normal;
}
```

#### 웹폰트 적용
사용하고자 하는 엘리먼트에 스타일을 적용합니다.

```
const MainTitle = styled.h2`
  font-family: 'S-Core Dream'; // font-face에 지정한 font-family 사용
  font-weight: 300; // 가중치에 맞는 폰트를 다운로드 하여 적용
  font-size: 22px;
  line-height: 32px;
  letter-spacing: -1px;
`
```

#### 웹폰트 적용 결과물(..실패!)
웹폰트를 적용한 결과물입니다. 개발환경에서는 문제가 없었습니다.

[결과물]

그러나! 웹은 네트워크 환경에 영향을 많이 받기 때문에 느린네트워크 환경에서도 테스트가 필요했고 잘 적용이 되나 싶었는데..... 실제 느린 네트워크 환경에서 확인 해보니 웹폰트가 적용되는 과정이 자연스럽지 현상이 발견되었습니다. (찰나의 순간이지만 지정한 웹폰트 적용시 딜레이)

[디자인 시안이미지와 느린 네트워크 환경에서의 결과물 이미지]

현상은 다음과 같다.

맨 처음 텍스트가 보이지 않음 → 웹폰트 다운로드 시간 지연 이유

텍스트가 보이다가.. 한글은 괜찮음 / 숫자 특문 영문이 명조체로 노출됨 (디자인상 매끄러워 보이지 않음) → 한글과 영문에 적용되는 폰트 이슈로 추정 

디자인된 웹폰트가 적용되나 제목영역이 bold 처리되어 첫 노출됨 → 브라우저 userAgent 스타일이 적용된 듯 (h태그는 기본 weight를 가지고 있음)

bold가 사라지고 최종 디자인된 화면 노출 → 스타일링한 스타일이 적용되면서 볼드 제거됨 
이제어야 디자인이 반영됨 

## 문제 해결 과정

폰트 적용 시점에 따라 첫 화면의 인상이 달라지기 때문에 사용자에게 가장 처음 노출되는 첫 화면 대한 고민을 다시금 해봅니다.
문제의 원인과 해결안을 찾아보자! 웹폰트 다운로드 및 적용에 영향을 줄수 있는 항목들을 정리해보며 해결안을 모색합니다.

- 웹폰트는 서버에서 다운로드 받아야하므로 네트워크의 속도에 영향을 받는다.
- 폰트 명세를 정의한 font-face 다운로드 시간도 고려해야한다.
- 웹 폰트의 용량 또한 다운로드 시간에 영향을 준다.
- 웹폰트 적용은 브라우저별 렌더링 처리 방식에 따라 다르다.

### 느린 네트워크 환경
네트워크 환경은 제어할 수 있는 영역은 아니지만 네트워크 요청시점을 앞당기거나 폴백폰트를 스타일링 해볼 수 있다.


#### preload

다른 어떤 것보다 먼저 폰트 리소스를 요청한다. 화면에 꼭 필수적인 폰트를 로딩해야 할 때 사용한다.

```
<link rel="preload" href="/static_fonts/NanumGothic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
```

문제점 
- Dom Contented loaded 시점 이전에 렌더링이 됨
- FOUT와 FOIT가 없어짐
- 그만큼 렌더링이 느려짐
- 마찬가지로 preload 옵션으로 다운로드하는 리소스가 많아질수록 처음 렌더링 시간이 늦어진다는 문제가 있다.


참고) as와 crossorigin이 있어야 두 번 다운로드하지 않음


#### 웹폰트와 비슷하게 디폴트(fallback)폰트 스타일링

폴백 폰트와 사용할 웹 폰트를 설정하면 속성을 비슷하게 하여 웹폰트 적용전까지 보여지는 텍스트를 최대한 비슷하게 맞춘다.

참고)
- https://sangziii.github.io/fontStyleMatcher/


### 웹 폰트 다운로드
#### 로컬 폰트 사용

로컬에 이미 폰트가 있다면? 다운로드 전 로컬 폰트 사용할 수 있습니다.
그러나 웹 폰트를 참조 하기 전 로컬에 설치된 서체가 우선 사용되도록 local 소스를 먼저 선언해주면 리소스를 요청하지 않습니다. 
그러나 local() 속성의 문제점들이 존재합니다.

- 웹 폰트는 브라우저에 따라 로컬 서체가 있는 경우에도 다운로드 될 수 있다.
- 로컬 서체를 로딩조차 못하는 웹 브라우저들이 존재한다. (IE6-8은 local() 속성을 인식 못함)
- 웹 브라우저 별로 참조하는 로컬 서체의 이름이 다르다.
- 운영체제별로 참조하는 로컬 서체의 이름이 다르다.
- 운영체제에 탑재된 웹 브라우저별로 참조하는 로컬 서체의 이름이 다르다.
- 한글 이름이 있는 글꼴은 한글과 영문 모두 작성하는 것이 좋은데 이는 영문으로만 작성했을 때 제대로 표시하지 못하는 브라우저가 있기 때문이다.

#### 폰트 명세는 CDN이 아닌 코드 저장소
초기에는 폰트명세(font-face)를 정의한 css파일 또한 CDN에 올려두고 다운로드 받았는데 다룬로드 시간을 줄이기 위해 코드 저장소에 추가하여 로드할 수 있도록  개선하였습니다. 외부에서 다운로드 받는 대신 내부에 가지고 있는다. 직접 글로벌 스타일에 적용하여 네트워크 요청수를 줄이고 폰트 다운로드 시점을 앞당깁니다.

### 폰트 용량 
폰트가 너무 무겁다. 용량이 크다.

#### 폰트 경량화
다운로드 시간에 영향을 줄수 있는 웹폰트 용량을 확인해보니 무려 `107kb`!!

- font scdream: 107kb / 원본 otf는..700kb / 웹폰트 변환 361kb / 경량화 버전으로 폰트로 주로 많이 사용하는 한글 글자 2,350개로 줄임 (https://martian36.com/1609)
- font roboto 11.3kb

참고) 구글에서 제공하는 웹폰트는 보통  10~20kb (https://fonts.google.com/?subset=korean)

#### unicode-range 또는 subset

@font-face의 속성 중 하나로 유니코드로 지정한 글자에만 웹 폰트를 적용합니다. 모~든 글자대응하지 말고 꼭 사용하는 한글만 적용하도록 합니다.

### 브라우저별 폰트 렌더링 방식

웹폰트가 깜빡거리거나 적용된 텍스트가 보이지 않는 문제 (브라우저 별 rendering 처리 방식)

#### FOIT (Flash of Invisible Text)

웹 폰트가 로드되기 전까지 보이지 않고 완료되면 보이는 방식. 네트워크가 지연될 때 웹 폰트의 로딩이 늦으면 빈 텍스트가 노출되는 문제점이 있다. 

- chrome, safari, firefox에서 발생

#### FOUT (Flash of Unstyled Text)

웹 폰트가 로드되기 전까지 폴백 폰트로 보여지고, 웹 폰트 로드가 완료되면 웹폰트로 바뀌는 방식. 웹 폰트 적용 전과 후에 글꼴의 자간, 높이 등 서식이 달라 reflow가 일어날 수 있다. 깜빡거림 

- IE , edge에서 발생



발생하는 이유는? 폰트 리소스를 받는 시점이 글꼴을 렌더링하는 시점과 경합이 일어나기 때문

FOIT 방식을 이용한다면 보이지 않는 텍스트가 중요한 텍스트라면 문제가 생길 수 있으므로 그렇기 때문에, FOUT 방식을 사용하되, reflow를 최소화하는 방식으로..!



참고) 관련 설정

font-display: @font-face의 속성

auto(기본값): 브라우저의 기본동작에 맡기는 방식이다.
block: FOIT 즉, 타임아웃까지 텍스트를 보여주지 않음
swap: 응답이 올 때까지 무한정 기다리고 그 전까진 바로 기본폰트를 보여준다. 꼭 적용해야만 하는 중요폰트일 경우에 쓸 수 있다.
fallback: 100ms 내외의 시간 동안만 block을 하고 기본폰트를 보여준다. 응답이 오면 해당 폰트로 swap 하지만 짧은 시간(3s)만 기다린다.
optional: 100ms 내외의 시간 동안만 block을 하고 기본폰트를 보여준다. 그 후에는 대체하지 않는다. => 폰트가 상관이 없을 때



fallback이 위에서 말한 FOIT를 방지하고 FOUT를 최소화하는 방법! 같아보이지만.. CSS로는 설정에 한계가 있다. 블로킹 타임 설정 불가. 100ms이내 폰트를 받기에는 너무 짧은 시간이기 때문에.

But..

CSS로는 설정에 한계가 있다. 블로킹 타임 설정 불가. 100ms이내 폰트를 받기에는 너무 짧은 시간.


// fallback이 위에서 말한 FOIT를 방지하고 FOUT를 최소화하는 방법! 같아보이지만.. CSS로는 설정에 한계가 있다. 블로킹 타임 설정 불가. 100ms이내 폰트를 받기에는 너무 짧은 시간이기 때문에.

### preload

다른 어떤 것보다 먼저 폰트 리소스를 요청한다. 화면에 꼭 필수적인 폰트를 로딩해야 할 때 사용한다.
 <link rel="preload" href="/static_fonts/NanumGothic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">

Dom Contented loaded 시점 이전에 렌더링이 됨
FOUT와 FOIT가 없어짐
그만큼 렌더링이 느려짐
마찬가지로 preload 옵션으로 다운로드하는 리소스가 많아질수록 처음 렌더링 시간이 늦어진다는 문제가 있다.

참고) 
as와 crossorigin이 있어야 두 번 다운로드하지 않음




### 겪었던 문제들
## 개선을 위한 노력들
- 웹폰트
- 웹폰트 경량화
- 결국 이미지폰트

임팩트있는 첫 화면을 구성을 위해 페이지에 웹폰트를 적용하는 경우, 리소스를 다운로드 받는 시간에 따른 폰트 적용 시점에 따라 첫페이지 인상이 달라질 수 있다.

## 웹폰트 사용의 문제점
맨 처음 텍스트가 보이지 않음 → 웹폰트 다운로드 시간 지연 이유
텍스트가 보이다가.. 한글은 괜찮음 / 숫자 특문 영문이 명조체로 노출됨 (디자인상 매끄러워 보이지 않음) → 한글과 영문에 적용되는 폰트 이슈로 추정 
디자인된 웹폰트가 적용되나 제목영역이 bold 처리되어 첫 노출됨 → 브라우저 userAgent 스타일이 적용된 듯 (h태그는 기본 weight를 가지고 있음)
bold가 사라지고 최종 디자인된 화면 노출 → 스타일링한 스타일이 적용되면서 볼드 제거됨 


따라서 웹폰트는 가벼워야 한다. 사용자가 기다리지 않고, 웹페이지를 아름답게 보여주려면 용량이 큰 웹폰트를 가볍게 해야 합니다. 

## 경량화

보통 경량화는 완성형 글꼴 중 사용 빈도가 낮은 문자들을 지워버리는 방식으로 진행됩니다. 꼭 포함될 필요가 없는 한자나 일본어가 포함되어 있다면 삭제합니다. 한글 중 사용 빈도가 낮은 문자들도 삭제하여 용량을 줄일 수 있습니다.


## 폰트종류
한글 영문 숫자 특수문자

## 적용
font-family



## 추가적인 노력들
srcset

----
- https://d2.naver.com/helloworld/4969726
- https://developer.mozilla.org/en-US/docs/Learn/CSS/Styling_text

